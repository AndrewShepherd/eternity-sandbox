<Window x:Class="Eternity.WpfApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Eternity.WpfApp"
        mc:Ignorable="d"
        Title="MainWindow" Height="450" Width="800"
	>
	<Window.Resources>
		<local:MainWindowViewModel x:Key="MainWindowViewModel" />
		<Style TargetType="{x:Type Button}">
			<Setter Property="Margin" Value="3,3,3,3" />
			<Setter Property="Padding" Value="3,3,3,3" />
		</Style>
	</Window.Resources>
	<Grid DataContext="{StaticResource MainWindowViewModel}">
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="4*" />
			<ColumnDefinition Width="3*" />
		</Grid.ColumnDefinitions>
		<ItemsControl ItemsSource="{Binding CanvasItems}" Grid.Column="0">
			<ItemsControl.ItemsPanel>
				<ItemsPanelTemplate>
					<Canvas />
				</ItemsPanelTemplate>
			</ItemsControl.ItemsPanel>
			<ItemsControl.Resources>
				<DataTemplate DataType="{x:Type local:CanvasPieceItem}">
					<Image Source="{Binding ImageSource}" RenderTransformOrigin="0.5, 0.5">
						<Image.RenderTransform>
							<RotateTransform Angle="{Binding Rotation}" />
						</Image.RenderTransform>
					</Image>
				</DataTemplate>
				<DataTemplate DataType="{x:Type local:CanvasHighlightItem}">
					<Rectangle
						Width="{Binding Width}"
						Height="{Binding Height}"
						Stroke="Yellow"
						StrokeThickness="4"
						/>
				</DataTemplate>
				<DataTemplate DataType="{x:Type local:CanvasConstraintItem}">
					<Border Width="{Binding Width}" Height="{Binding Height}" Padding="6,6,6,6">
						<Viewbox>
							<TextBlock Text="{Binding Count}" />
						</Viewbox>
					</Border>
				</DataTemplate>
			</ItemsControl.Resources>
			<ItemsControl.ItemContainerStyle>
				<Style TargetType="ContentPresenter">
					<Setter Property="Canvas.Left" Value="{Binding Left}" />
					<Setter Property="Canvas.Top" Value="{Binding Top}" />
				</Style>
			</ItemsControl.ItemContainerStyle>
		</ItemsControl>
		<StackPanel Orientation="Vertical" Grid.Column="1">
			<StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
				<Button Command="{Binding ResetSequenceCommand}">
					Reset
				</Button>
				<Button Command="{Binding GenerateRandomCommand}">
					Random
				</Button>
				<Button Command="{Binding StepBackwardsCommand}">
					&lt; Step
				</Button>
				<Button Command="{Binding GoBackwardsCommand}">
					&lt; &lt; Backwards
				</Button>
				<Button Command="{Binding StartCommand}">
					Forwards &gt;&gt;
				</Button>
				<Button Command="{Binding StopCommand}">
					Stop
				</Button>
				<Button Command="{Binding StepForwardCommand}">
					Step &gt;
				</Button>
			</StackPanel>
			<ListView 
				ItemsSource="{Binding SequenceListEntries}"
				SelectedIndex="{Binding Mode=OneWayToSource, Path=SelectedSequenceIndex}"
			>
				<ListView.ItemsPanel>
					<ItemsPanelTemplate>
						<UniformGrid Columns="16" />
					</ItemsPanelTemplate>
				</ListView.ItemsPanel>
				<ListView.ItemTemplate>
					<DataTemplate>
						<TextBlock 
							FontSize="16"
							FontFamily="Courier New"
							TextAlignment="Right"
							HorizontalAlignment="Stretch"
							Text="{Binding ValueAsHex}" />
					</DataTemplate>
				</ListView.ItemTemplate>
			</ListView>
			<TextBlock Text="{Binding SelectedSequenceIndex}" 
					   FontSize="16" FontFamily="Courier New"
					   HorizontalAlignment="Center"
					    />
			<StackPanel Orientation="Horizontal">
				<TextBlock>Placements: </TextBlock>
				<TextBlock Text="{Binding PlacementCount}" />
			</StackPanel>

		</StackPanel>
	</Grid>
</Window>
